
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="simulation_flow.html">
      
      
        <link rel="next" href="concurrency.html">
      
      
        
          <link rel="alternate" href="co_simulation.html" hreflang="en">
        
          <link rel="alternate" href="../../zh/explanation/tricys_basic/co_simulation.html" hreflang="zh">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Co-simulation Principle - TRitium Integrated CYcle Simulation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-interceptor-mode" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="TRitium Integrated CYcle Simulation" class="md-header__button md-logo" aria-label="TRitium Integrated CYcle Simulation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TRitium Integrated CYcle Simulation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Co-simulation Principle
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="co_simulation.html" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/explanation/tricys_basic/co_simulation.html" hreflang="zh" class="md-select__link">
              ÁÆÄ‰Ωì‰∏≠Êñá
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/asipp-neutronics/tricys" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    TRICYS
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/quickstart.html" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../architecture.html" class="md-tabs__link">
          
  
  
  Explanation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/tricys_simulation.html" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../questions/installation.html" class="md-tabs__link">
          
  
  
  FAQ

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../changelog.html" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../license.html" class="md-tabs__link">
        
  
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="TRitium Integrated CYcle Simulation" class="md-nav__button md-logo" aria-label="TRitium Integrated CYcle Simulation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TRitium Integrated CYcle Simulation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/asipp-neutronics/tricys" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    TRICYS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Model Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Model Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/models/cycle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tritium Fuel Cycle 0D System Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Basic Simulation (TRICYS BASIC)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Basic Simulation (TRICYS BASIC)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_basic/basic_configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_basic/parameter_sweep.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parameter Sweep
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_basic/concurrent_operation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concurrent Operation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_basic/post_processing_module.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Post-processing Module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_basic/co_simulation_module.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Co-simulation Module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Automated Analysis (TRICYS ANALYSIS)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Automated Analysis (TRICYS ANALYSIS)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_analysis/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction & Common Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_analysis/baseline_condition_analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Baseline Condition Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_analysis/single_parameter_sensitivity_analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single Parameter Sensitivity Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_analysis/multi_parameter_sensitivity_analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-parameter Sensitivity Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_analysis/sobol_global_sensitivity_analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOBOL Global Sensitivity Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/tricys_analysis/latin_uncertainty_analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Latin Uncertainty Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Explanation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Explanation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Basic Simulation (TRICYS BASIC)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Basic Simulation (TRICYS BASIC)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="simulation_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Co-simulation Principle
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="co_simulation.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Co-simulation Principle
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-interceptor-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Interceptor Mode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Interceptor Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1. How It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2. Architecture Diagram
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-implementation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3. Implementation Steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-interceptor-model-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4. Interceptor Model Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-direct-replacement-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Direct Replacement Mode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Direct Replacement Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1. How It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. Architecture Diagram
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-implementation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3. Implementation Steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-post-replacement-model-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4. Post-Replacement Model Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-writing-your-own-handler" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Writing Your Own Handler
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Writing Your Own Handler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-handler-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. Handler Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-function-signature-and-responsibilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Function Signature and Responsibilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-return-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3. Return Value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-complete-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4. Complete Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="concurrency.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concurrency Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Automated Analysis (TRICYS ANALYSIS)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Automated Analysis (TRICYS ANALYSIS)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tricys_analysis/analysis_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tricys_analysis/performance_metrics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Performance Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tricys_analysis/analysis_report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating Analysis Reports
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tricys_analysis/salib_integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SALIB Integration Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tricys_simulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tricys.simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tricys_core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tricys.core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tricys_utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tricys.utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tricys_analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tricys.analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tricys_postprocess.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tricys.postprocess
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tricys_handlers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tricys.handlers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    FAQ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../questions/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üöÄ Installation & Environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../questions/configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ‚öôÔ∏è Configuration & Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../questions/advanced_features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üî¨ Advanced Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../questions/troubleshooting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üêõ Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../questions/best_practices.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üí° Best Practices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-interceptor-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Interceptor Mode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Interceptor Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1. How It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2. Architecture Diagram
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-implementation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3. Implementation Steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-interceptor-model-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4. Interceptor Model Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-direct-replacement-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Direct Replacement Mode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Direct Replacement Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1. How It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. Architecture Diagram
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-implementation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3. Implementation Steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-post-replacement-model-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4. Post-Replacement Model Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-writing-your-own-handler" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Writing Your Own Handler
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Writing Your Own Handler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-handler-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. Handler Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-function-signature-and-responsibilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Function Signature and Responsibilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-return-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3. Return Value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-complete-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4. Complete Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Co-simulation Principle</h1>

<p>In co-simulation, TRICYS provides two methods for injecting external data into a Modelica model.</p>
<h2 id="1-interceptor-mode">1. Interceptor Mode<a class="headerlink" href="#1-interceptor-mode" title="Permanent link">&para;</a></h2>
<h3 id="11-how-it-works">1.1. How It Works<a class="headerlink" href="#11-how-it-works" title="Permanent link">&para;</a></h3>
<p>The interceptor mode is a <strong>non-invasive</strong> method for data injection. It does not modify any original model files; instead, it works by automatically generating new models.</p>
<p>The core idea is to dynamically insert a new "interceptor" model between the original submodel and downstream components. This interceptor acts like a configurable switch, receiving both the real-time output signals from the <strong>original submodel</strong> and predefined data from a <strong>CSV file</strong>. By setting model parameters at runtime, you can precisely control whether each output signal "passes through" the upstream real-time signal or is "overridden" with data from the CSV file.</p>
<p>The advantage of this mode lies in its safety and flexibility. All modifications are made on automatically generated copies (e.g., <code>_Intercepted.mo</code>), leaving the original model and system design unchanged. This makes it ideal for "what-if" analysis, fault injection, or temporarily replacing parts of the system's behavior.</p>
<h3 id="12-architecture-diagram">1.2. Architecture Diagram<a class="headerlink" href="#12-architecture-diagram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Original System Structure:
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>  [Upstream Model] --&gt; [Submodel] --&gt; [Downstream Model]
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>Interceptor Mode Structure:
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  [Upstream Model] --&gt; [Submodel] --&gt; [Interceptor] --&gt; [Downstream Model]
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                     ‚Üë
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                 [CSV Data]
</code></pre></div>
<h3 id="13-implementation-steps">1.3. Implementation Steps<a class="headerlink" href="#13-implementation-steps" title="Permanent link">&para;</a></h3>
<p><code>tricys</code> automatically completes the following steps to implement the interceptor mode:</p>
<pre class="mermaid"><code>graph TD
    A[Start] --&gt; B{Read Co-simulation Config};
    B --&gt; C[Analyze target submodel via&lt;br&gt;OMCSession to get all output ports];
    C --&gt; D[Dynamically generate a corresponding&lt;br&gt;'..._Interceptor.mo' model file for the submodel];
    D --&gt; E[Read the top-level system model's code];
    E --&gt; F{Reconstruct connection&lt;br&gt;relationships in the system model};
    F --&gt; G[1. Declare and instantiate the interceptor model];
    F --&gt; H[2. Modify connect statements&lt;br&gt;to redirect original connections to the interceptor];
    G &amp; H --&gt; I[Save the modified system model&lt;br&gt;as an '..._Intercepted.mo' file];
    I --&gt; J[End];

    style C fill:#f9f,stroke:#333,stroke-width:2px;
    style D fill:#ccf,stroke:#333,stroke-width:2px;
    style F fill:#f9f,stroke:#333,stroke-width:2px;
    style I fill:#ccf,stroke:#333,stroke-width:2px;</code></pre>
<p>Detailed breakdown of steps:
1.  <strong>Analyze Model</strong>: <code>tricys</code> first uses the OpenModelica (OMC) toolchain to analyze the target submodel, automatically identifying all its output ports, dimensions, and other metadata.
2.  <strong>Generate Interceptor</strong>: Based on the port information obtained in the previous step, a new Modelica model (<code>..._Interceptor.mo</code>) is dynamically generated. This model contains a <code>CombiTimeTable</code> component (for reading CSVs) and data selection logic.
3.  <strong>Modify System</strong>: <code>tricys</code> reads the code of the top-level system model and performs the following modifications:
    *   <strong>Instantiate Interceptor</strong>: An instance declaration for the newly generated interceptor model is added before the <code>equation</code> section.
    *   <strong>Redirect Connections</strong>: <code>connect</code> statements are automatically found and modified using regular expressions. The original connections from the submodel's output ports to downstream components are broken and rerouted through the interceptor:
        *   <code>Submodel.OutputPort</code> -&gt; <code>Interceptor.PhysicalInputPort</code>
        *   <code>Interceptor.FinalOutputPort</code> -&gt; <code>DownstreamComponent.InputPort</code>
4.  <strong>Save New System</strong>: The content of the modified top-level system model is saved to a new file with an <code>_Intercepted</code> suffix, ensuring the original system model file remains unaffected.</p>
<h3 id="14-interceptor-model-example">1.4. Interceptor Model Example<a class="headerlink" href="#14-interceptor-model-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kr">within</span> <span class="nn">example_model</span><span class="p">;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kr">model</span> <span class="nc">Plasma_Interceptor</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  <span class="c1">// Receive original model output</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealInput</span> <span class="n">physical_to_Pump</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  <span class="c1">// Final output</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealOutput</span> <span class="n">final_to_Pump</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>  <span class="kr">protected</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="kr">parameter</span> <span class="nb">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="s2">&quot;plasma_data.csv&quot;</span><span class="p">;</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="c1">// Column mapping parameter: [time, y1, y2, y3, y4, y5]</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="c1">// If a column is set to 1, it means use physical data instead of CSV</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="kr">parameter</span> <span class="nb">Integer</span> <span class="n">columns_to_Pump</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">};</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="c1">// CSV reader</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Sources</span><span class="o">.</span><span class="n">CombiTimeTable</span> <span class="n">table_to_Pump</span><span class="p">(</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>      <span class="n">tableName</span><span class="o">=</span><span class="s2">&quot;csv_data_to_Pump&quot;</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>      <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>      <span class="n">columns</span><span class="o">=</span><span class="n">columns_to_Pump</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>      <span class="n">tableOnFile</span><span class="o">=</span><span class="kc">true</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>    <span class="p">);</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>  <span class="kr">equation</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    <span class="c1">// Select data source element-wise</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>    <span class="kr">for</span> <span class="n">i</span> <span class="kr">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span> <span class="kr">loop</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>      <span class="n">final_to_Pump</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kr">if</span> <span class="n">columns_to_Pump</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&gt;</span> <span class="mi">1</span> 
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>                         <span class="kr">then</span> <span class="n">table_to_Pump</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="c1">// Use CSV</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>                         <span class="kr">else</span> <span class="n">physical_to_Pump</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">// Use physical data</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>    <span class="kr">end</span> <span class="kr">for</span><span class="p">;</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="kr">end</span> <span class="nc">Plasma_Interceptor</span><span class="p">;</span>
</code></pre></div>
<hr />
<h2 id="2-direct-replacement-mode">2. Direct Replacement Mode<a class="headerlink" href="#2-direct-replacement-mode" title="Permanent link">&para;</a></h2>
<h3 id="21-how-it-works">2.1. How It Works<a class="headerlink" href="#21-how-it-works" title="Permanent link">&para;</a></h3>
<p>The direct replacement mode is an <strong>invasive</strong> but efficient method. It directly modifies the target submodel's file, completely replacing its original internal logic with a "data player."</p>
<p>The workflow is as follows: <code>tricys</code> first creates a backup file (<code>.bak</code>) for the target submodel. Then, it "clears" all internal equations and variables from the original model file, retaining only its input/output port declarations. Next, it adds <code>CombiTimeTable</code> components to the model and directly connects the output ports to the data outputs of these components.</p>
<p>Ultimately, the submodel becomes a simple data source whose behavior is entirely defined by an external CSV file. This mode is suitable when you need to permanently or semi-permanently replace a computationally expensive or temporarily unavailable submodel with a fixed dataset (e.g., results from a high-fidelity simulation or experimental data).</p>
<h3 id="22-architecture-diagram">2.2. Architecture Diagram<a class="headerlink" href="#22-architecture-diagram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Original System Structure:
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  [Upstream Model] --&gt; [Submodel] --&gt; [Downstream Model]
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>Direct Replacement Mode:
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  [Upstream Model] --&gt; [Submodel (CSV Version)] --&gt; [Downstream Model]
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>                             ‚Üë
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>                         [CSV Data]
</code></pre></div>
<h3 id="23-implementation-steps">2.3. Implementation Steps<a class="headerlink" href="#23-implementation-steps" title="Permanent link">&para;</a></h3>
<p><code>tricys</code> implements direct replacement through the following automated process:</p>
<pre class="mermaid"><code>graph TD
    A[Start] --&gt; B{Read Co-simulation Config};
    B --&gt; C[Locate the target submodel's '.mo' file];
    C --&gt; D[Create a backup of the file&lt;br&gt;e.g., 'SubModel.mo' -&gt; 'SubModel.bak'];
    D --&gt; E[Read the model code&lt;br&gt;retaining only port declarations and the model frame];
    E --&gt; F[Generate new model content];
    F --&gt; G[1. Add CombiTimeTable components&lt;br&gt;for reading CSV data];
    F --&gt; H[2. Create a new equation section&lt;br&gt;to directly connect output ports to the Table's output];
    G &amp; H --&gt; I[Overwrite the original '.mo' file&lt;br&gt;with the newly generated code];
    I --&gt; J[End];

    style D fill:#f9f,stroke:#333,stroke-width:2px;
    style F fill:#f9f,stroke:#333,stroke-width:2px;
    style I fill:#ccf,stroke:#333,stroke-width:2px;</code></pre>
<p>Detailed breakdown of steps:
1.  <strong>Locate and Backup</strong>: Based on the <code>submodel_name</code>, <code>tricys</code> finds the corresponding <code>.mo</code> file in the project directory and immediately creates a backup file with a <code>.bak</code> suffix to prevent data loss.
2.  <strong>Parse and Clear</strong>: The program reads the original model code and parses its complete input/output port declarations. It then discards all other content in the model, such as variables in the <code>parameter</code> and <code>protected</code> sections, and all equations in the <code>equation</code> section.
3.  <strong>Generate New Code</strong>: <code>tricys</code> generates brand new model code based on the parsed port information:
    *   It retains the original port declarations to ensure its external interface remains unchanged.
    *   For each output port that needs to be driven by CSV data, it adds a <code>CombiTimeTable</code> instance and configures parameters like <code>fileName</code> and <code>columns</code>.
    *   It creates a new <code>equation</code> section with simple mapping statements like <code>output_port = table.y</code> to directly connect the output ports to the <code>CombiTimeTable</code>'s data outputs.
4.  <strong>Overwrite File</strong>: Finally, <code>tricys</code> completely overwrites the original <code>.mo</code> file with the newly generated code, completing the replacement process. Since the submodel's interface (ports) has not changed, the top-level system model requires no modifications.</p>
<h3 id="24-post-replacement-model-example">2.4. Post-Replacement Model Example<a class="headerlink" href="#24-post-replacement-model-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kr">within</span> <span class="nn">example_model</span><span class="p">;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kr">model</span> <span class="nc">Plasma</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  <span class="c1">// Original port declarations remain unchanged</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealInput</span> <span class="n">pulseInput</span><span class="p">;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealOutput</span> <span class="n">from_Fueling_System</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealOutput</span> <span class="n">to_FW</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealOutput</span> <span class="n">to_Div</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Interfaces</span><span class="o">.</span><span class="n">RealOutput</span> <span class="n">to_Pump</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="kr">protected</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>  <span class="kr">parameter</span> <span class="nb">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="s2">&quot;plasma_data.csv&quot;</span><span class="p">;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>  <span class="c1">// CSV Data Source</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Sources</span><span class="o">.</span><span class="n">CombiTimeTable</span> <span class="n">table_to_Pump</span><span class="p">(</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    <span class="n">tableName</span><span class="o">=</span><span class="s2">&quot;csv_data_to_Pump&quot;</span><span class="p">,</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>    <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">},</span>  <span class="c1">// time + 5 data columns</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    <span class="n">tableOnFile</span><span class="o">=</span><span class="kc">true</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>  <span class="p">);</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>  <span class="n">Modelica</span><span class="o">.</span><span class="n">Blocks</span><span class="o">.</span><span class="n">Sources</span><span class="o">.</span><span class="n">CombiTimeTable</span> <span class="n">table_to_FW</span><span class="p">(</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>    <span class="n">tableName</span><span class="o">=</span><span class="s2">&quot;csv_data_to_FW&quot;</span><span class="p">,</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>    <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>    <span class="n">tableOnFile</span><span class="o">=</span><span class="kc">true</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>  <span class="p">);</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>  <span class="c1">// ... table definitions for other ports ...</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="kr">equation</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>  <span class="c1">// Directly map CSV to output (ignoring input)</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>  <span class="kr">for</span> <span class="n">i</span> <span class="kr">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span> <span class="kr">loop</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>    <span class="n">to_Pump</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_to_Pump</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>    <span class="n">to_FW</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_to_FW</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>    <span class="n">to_Div</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_to_Div</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>    <span class="n">from_Fueling_System</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_from_Fueling_System</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>  <span class="kr">end</span> <span class="kr">for</span><span class="p">;</span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="kr">end</span> <span class="nc">Plasma</span><span class="p">;</span>
</code></pre></div>
<hr />
<h2 id="3-writing-your-own-handler">3. Writing Your Own Handler<a class="headerlink" href="#3-writing-your-own-handler" title="Permanent link">&para;</a></h2>
<p>Besides using the built-in processors, the most powerful feature of the <code>tricys</code> co-simulation framework is the ability to write your own Python functions (handlers) to dynamically generate data for injection into the Modelica model. This means you can integrate any complex external models, algorithms, or data sources.</p>
<h3 id="31-handler-configuration">3.1. Handler Configuration<a class="headerlink" href="#31-handler-configuration" title="Permanent link">&para;</a></h3>
<p>In the <code>co_simulation.handlers</code> list in <code>config.json</code>, each handler object contains the following fields to define its behavior:</p>
<ul>
<li>
<p><strong><code>handler_module</code> or <code>handler_script_path</code></strong> (string, one is required):</p>
<ul>
<li><strong><code>handler_module</code></strong>: Specifies the full path of the <strong>Python module</strong> where the handler function is located. Suitable for cases where the code is part of a standard Python package.</li>
<li><strong><code>handler_script_path</code></strong>: Specifies the path to the <strong>Python script file</strong> containing the handler function. This is more flexible and suitable for standalone script files.</li>
</ul>
</li>
<li>
<p><strong><code>handler_function</code></strong> (string, required):</p>
<ul>
<li><strong>Description</strong>: The name of the function to be called within the specified module or script.</li>
</ul>
</li>
<li>
<p><strong><code>params</code></strong> (dictionary, optional):</p>
<ul>
<li><strong>Description</strong>: A dictionary containing arbitrary keyword arguments to be passed to the handler function.</li>
</ul>
</li>
</ul>
<h3 id="32-function-signature-and-responsibilities">3.2. Function Signature and Responsibilities<a class="headerlink" href="#32-function-signature-and-responsibilities" title="Permanent link">&para;</a></h3>
<p>To be correctly called by the <code>tricys</code> framework, your handler function <strong>must</strong> follow a specific signature. The framework automatically passes two core paths via <strong>keyword arguments</strong>, which your function needs to define and accept:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_handler</span><span class="p">(</span><span class="n">temp_input_csv</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp_output_csv</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="sd">    A standard handler function signature.</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="sd">        temp_input_csv (str): The path to a CSV file containing the output results</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="sd">                              from the upstream model. You can read this file</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="sd">                              to get the inputs that drive your calculation.</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="sd">        temp_output_csv (str): The path to a target CSV file where you need to</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="sd">                               write your calculation results. tricys will provide</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="sd">                               this file to Modelica&#39;s CombiTimeTable.</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="sd">        **kwargs: Used to receive all custom parameters from &quot;params&quot; in the JSON config.</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="sd">    Returns:</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="sd">        dict: A dictionary used to configure the column mapping for the Modelica CombiTimeTable.</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="c1"># ... Your code logic here ...</span>
</code></pre></div>
<p><strong>Core Responsibilities</strong>:
1.  <strong>Read Input (Optional)</strong>: Use Pandas or another library to read the <code>temp_input_csv</code> file and get the dynamic output from the upstream model.
2.  <strong>Perform Calculation</strong>: Run your model, algorithm, or any other logic.
3.  <strong>Write Output</strong>: Save your calculation results (which must include a <code>time</code> column) in CSV format to the path specified by <code>temp_output_csv</code>.</p>
<h3 id="33-return-value">3.3. Return Value<a class="headerlink" href="#33-return-value" title="Permanent link">&para;</a></h3>
<p>The handler function <strong>must</strong> return a dictionary. The <strong>keys</strong> of this dictionary correspond to the <strong>output port names</strong> of the Modelica submodel, and the <strong>values</strong> are strings used to configure the <code>columns</code> parameter of the <code>CombiTimeTable</code>, defining how to read data columns from your generated CSV file.</p>
<ul>
<li><strong>Example</strong>: <code>return {"to_CL": "{1,2,3,4,5,6}"}</code></li>
<li>This tells <code>tricys</code> that for the output port named <code>to_CL</code>, the generated <code>CombiTimeTable</code> should use columns 1 through 6 of the data you wrote in <code>temp_output_csv</code> (where column 1 is typically <code>time</code>).</li>
</ul>
<h3 id="34-complete-example">3.4. Complete Example<a class="headerlink" href="#34-complete-example" title="Permanent link">&para;</a></h3>
<p>Taking the built-in <code>div_handler.py</code> as an example, it simulates a simple external model that does not depend on upstream input but generates its own data.</p>
<p><strong>Step 1: Create the Handler Script</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># tricys/handlers/div_handler.py</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_div_simulation</span><span class="p">(</span><span class="n">temp_input_csv</span><span class="p">,</span> <span class="n">temp_output_csv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="sd">    A simple handler that reads a predefined CSV file and writes its content</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="sd">    to the target output path specified by the framework.</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="c1"># Get the directory of the current file to locate the data file</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="n">handler_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>    <span class="n">source_csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">handler_dir</span><span class="p">,</span> <span class="s2">&quot;div_handler.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="c1"># Read the source data</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="n">source_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source_csv_path</span><span class="p">)</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="c1"># Define the columns to be output to Modelica</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>    <span class="n">columns_to_select</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>        <span class="s2">&quot;time&quot;</span><span class="p">,</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        <span class="s2">&quot;div.to_CL[1]&quot;</span><span class="p">,</span> <span class="s2">&quot;div.to_CL[2]&quot;</span><span class="p">,</span> <span class="s2">&quot;div.to_CL[3]&quot;</span><span class="p">,</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>        <span class="s2">&quot;div.to_CL[4]&quot;</span><span class="p">,</span> <span class="s2">&quot;div.to_CL[5]&quot;</span><span class="p">,</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="p">]</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>    <span class="n">output_df</span> <span class="o">=</span> <span class="n">source_df</span><span class="p">[</span><span class="n">columns_to_select</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="c1"># Write the processed data to the target CSV file specified by the framework</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>    <span class="n">output_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">temp_output_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>    <span class="c1"># Return the mapping between ports and columns</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>    <span class="n">output_placeholder</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;to_CL&quot;</span><span class="p">:</span> <span class="s2">&quot;{1,2,3,4,5,6}&quot;</span><span class="p">}</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>    <span class="k">return</span> <span class="n">output_placeholder</span>
</code></pre></div>
<p><strong>Step 2: Configure in <code>config.json</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">&quot;co_simulation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;interceptor&quot;</span><span class="p">,</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">            </span><span class="nt">&quot;submodel_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;example_model.DIV&quot;</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">            </span><span class="nt">&quot;instance_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;div&quot;</span><span class="p">,</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">            </span><span class="nt">&quot;handler_module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tricys.handlers.div_handler&quot;</span><span class="p">,</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">            </span><span class="nt">&quot;handler_function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;run_div_simulation&quot;</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">            </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="p">]</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="p">}</span>
</code></pre></div>
<p>In this configuration, <code>tricys</code> will:
1.  Import the <code>tricys.handlers.div_handler</code> module.
2.  Call the <code>run_div_simulation</code> function.
3.  After the function executes, a new CSV file is generated.
4.  Use the returned <code>{"to_CL": "{1,2,3,4,5,6}"}</code> to configure the <code>CombiTimeTable</code> injected into the Modelica simulation.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="simulation_flow.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Simulation Flow">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Simulation Flow
              </div>
            </div>
          </a>
        
        
          
          <a href="concurrency.html" class="md-footer__link md-footer__link--next" aria-label="Next: Concurrency Model">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Concurrency Model
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.footer", "navigation.top", "search.highlight", "search.suggest", "navigation.tabs", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>